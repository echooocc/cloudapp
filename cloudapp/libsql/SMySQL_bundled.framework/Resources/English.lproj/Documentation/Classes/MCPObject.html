<HTML><HEAD><TITLE></TITLE></HEAD>
<BODY BGCOLOR="#FFFFFF">


<BR><BR><FONT COLOR="#000066"><H1><A NAME="//apple_ref/occ/cl/MCPObject">MCPObject</A></H1></FONT><BR>



	<blockquote><DL><DT><B>Inherits From:</B></DT>  
	<DD>NSObject</DD>
</DL></blockquote>





	<blockquote><DL><DT><B>Declared In:</B></DT>
	<DD>MCPObject.h</DD>
	</DL></blockquote>

<BR><BR>


<H2>Class Description</H2>
No class description.



	<P><HR WIDTH=50% ALIGN=LEFT>
	<H2>Defined Types</H2>
	<blockquote>
	
		
		<H4>Synopsis:</H4>
		
			<CODE><A NAME="//apple_ref/c/tdef/MCPDBReturnCode">
			typedef enum {&nbsp;&nbsp;&nbsp;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;MCPDBReturnUnknown = 0, <BR>
&nbsp;&nbsp;&nbsp;&nbsp;MCPDBReturnDeleted = 1, <BR>
&nbsp;&nbsp;&nbsp;&nbsp;MCPDBReturnUsed = 2, <BR>
&nbsp;&nbsp;&nbsp;&nbsp;MCPDBReturnNone = 3, <BR>
&nbsp;&nbsp;&nbsp;&nbsp;MCPDBReturnNew = 4, <BR>
&nbsp;&nbsp;&nbsp;&nbsp;MCPDBReturnUpdated = 5, <BR>
&nbsp;&nbsp;&nbsp;&nbsp;MCPDBReturnIncompleteKey = 6, <BR>
&nbsp;&nbsp;&nbsp;&nbsp;MCPDBReturnMultiple = 7, <BR>
&nbsp;&nbsp;&nbsp;&nbsp;MCPDBReturnNoIdentity = 8, <BR>
&nbsp;&nbsp;&nbsp;&nbsp;MCPDBReturnNoKey = 9, <BR>
&nbsp;&nbsp;&nbsp;&nbsp;MCPDBReturnNoConnection = 10, <BR>
&nbsp;&nbsp;&nbsp;&nbsp;MCPDBReturnOK = 100 <BR>
} <B>MCPDBReturnCode</B>;</A></CODE><BR>
		
		
		<H4>Description:</H4>
		Possible return code on some operations of the database interaction.
		
	
	</blockquote>















	<P><HR WIDTH=50% ALIGN=LEFT>
	<H2>Instance Variables</H2>
	<blockquote>
	
		<CODE>MCPClassDescription *<B>classDescription</B>;</CODE><BR>
		<CODE>MCPConnection *<B>connection</B>;</CODE><BR>
	<P><TABLE>
	
		<TR><TD>classDescription</TD><TD>No description.</TD></TR>
	
		<TR><TD>connection</TD><TD>No description.</TD></TR>
	
	</TABLE>
	</blockquote>




	<P><HR WIDTH=50% ALIGN=LEFT>
	<H2>Method Types</H2>
	<blockquote>
	
		
			Life of the object
		
		<DL><DT></DT>
		
			<DD> <A HREF="#- init">- init</A></DD>
		
			<DD> <A HREF="#- dealloc">- dealloc</A></DD>
		
			<DD> <A HREF="#- setAttributesToDefault">- setAttributesToDefault</A></DD>
		
		</DL>
	
		
			Accessor(s)
		
		<DL><DT></DT>
		
			<DD> <A HREF="#- classDescription">- classDescription</A></DD>
		
			<DD> <A HREF="#- connection">- connection</A></DD>
		
			<DD> <A HREF="#- setConnection:">- setConnection:</A></DD>
		
		</DL>
	
		
			Database interface
		
		<DL><DT></DT>
		
			<DD> <A HREF="#- readFromDBRow:withTableName:">- readFromDBRow:withTableName:</A></DD>
		
			<DD> <A HREF="#- setPrimaryKey:andFetchFromDB:">- setPrimaryKey:andFetchFromDB:</A></DD>
		
			<DD> <A HREF="#- checkDBId">- checkDBId</A></DD>
		
			<DD> <A HREF="#- saveInDB">- saveInDB</A></DD>
		
			<DD> <A HREF="#- getAutoGenerated">- getAutoGenerated</A></DD>
		
			<DD> <A HREF="#- updateInDB">- updateInDB</A></DD>
		
			<DD> <A HREF="#- deleteInDB">- deleteInDB</A></DD>
		
			<DD> <A HREF="#+ deleteInDBUsingConnection:withId:">+ deleteInDBUsingConnection:withId:</A></DD>
		
		</DL>
	
		
			Utiliy method
		
		<DL><DT></DT>
		
			<DD> <A HREF="#- defaultValueForKey:">- defaultValueForKey:</A></DD>
		
			<DD> <A HREF="#- primaryKey">- primaryKey</A></DD>
		
		</DL>
	
		
			Output :
		
		<DL><DT></DT>
		
			<DD> <A HREF="#- description">- description</A></DD>
		
		</DL>
	
		
			Anti-crash method...
		
		<DL><DT></DT>
		
			<DD> <A HREF="#- setNilValueForKey:">- setNilValueForKey:</A></DD>
		
		</DL>
	
	</blockquote>




	<P><HR WIDTH=50% ALIGN=LEFT>
	<H2>Class Methods</H2>
 
	
		
		<A NAME="+ deleteInDBUsingConnection:withId:"></A><H3><A NAME="//apple_ref/occ/clm/MCPObject/deleteInDBUsingConnection:withId:">deleteInDBUsingConnection:withId:</A></H3>
		<CODE>+ (MCPDBReturnCode)<B>deleteInDBUsingConnection:</B>(MCPConnection *)<EM>iConnection</EM> <B>withId:</B>(id)<EM>iId</EM>
			
		</CODE><P>
		Uses the connection to remove from the DB the entry corresponding to the primary key <B>id</B> given by <I>iId</I>. 
If any part of the primary key is missing, nothing is done.
	


 

	<HR WIDTH=50% ALIGN=LEFT>
	<H2>Instance Methods</H2>
 
	
		
		<A NAME="- checkDBId"></A><H3><A NAME="//apple_ref/occ/instm/MCPObject/checkDBId">checkDBId</A></H3><P>
		<CODE>- (NSDictionary *)<B>checkDBId</B>
		</CODE><P>
		Using the identity properties of the class, this method will check if <B>self</B> already exists in the DB, 
in which case it will set the primary key attributes to match the DB entry. If the object is not present 
in the DB, the primary key attributes are set to null.<P>

The returned dictionary contains the values of the primary key attributes. It also contains one entry with 
key MCPDBReturnCode, which contains the result of the operation (was the object in DB?).<P>

If the identityAttributes of the class description is empty, the entry will always be considered not to be 
in the DB, AND the primary key attributes of the object will be left unchnaged and returned as they are at 
call time.
	
		<P><HR WIDTH=25% ALIGN=LEFT>
		<A NAME="- classDescription"></A><H3><A NAME="//apple_ref/occ/instm/MCPObject/classDescription">classDescription</A></H3><P>
		<CODE>- (MCPClassDescription *)<B>classDescription</B>
		</CODE><P>
		No method description.
	
		<P><HR WIDTH=25% ALIGN=LEFT>
		<A NAME="- connection"></A><H3><A NAME="//apple_ref/occ/instm/MCPObject/connection">connection</A></H3><P>
		<CODE>- (MCPConnection *)<B>connection</B>
		</CODE><P>
		No method description.
	
		<P><HR WIDTH=25% ALIGN=LEFT>
		<A NAME="- dealloc"></A><H3><A NAME="//apple_ref/occ/instm/MCPObject/dealloc">dealloc</A></H3><P>
		<CODE>- (void)<B>dealloc</B>
		</CODE><P>
		Deallocating the class description, then passes the message to <B>super</B>.
	
		<P><HR WIDTH=25% ALIGN=LEFT>
		<A NAME="- defaultValueForKey:"></A><H3><A NAME="//apple_ref/occ/instm/MCPObject/defaultValueForKey:">defaultValueForKey:</A></H3><P>
		<CODE>- (id)<B>defaultValueForKey:</B>(NSString *)<EM>iKey</EM>
			
		</CODE><P>
		This method will return the default value (object) for the given key.
	
		<P><HR WIDTH=25% ALIGN=LEFT>
		<A NAME="- deleteInDB"></A><H3><A NAME="//apple_ref/occ/instm/MCPObject/deleteInDB">deleteInDB</A></H3><P>
		<CODE>- (MCPDBReturnCode)<B>deleteInDB</B>
		</CODE><P>
		Uses the connection to delete the object from the DB. In this process the autoGenerated attributes are set to null. 
If the primary key is not completely set, this method calls checkDBId... method to try to complete it 
(if the identityAttributes of the class description is not empty).
	
		<P><HR WIDTH=25% ALIGN=LEFT>
		<A NAME="- description"></A><H3><A NAME="//apple_ref/occ/instm/MCPObject/description">description</A></H3><P>
		<CODE>- (NSString *)<B>description</B>
		</CODE><P>
		No method description.
	
		<P><HR WIDTH=25% ALIGN=LEFT>
		<A NAME="- getAutoGenerated"></A><H3><A NAME="//apple_ref/occ/instm/MCPObject/getAutoGenerated">getAutoGenerated</A></H3><P>
		<CODE>- (MCPDBReturnCode)<B>getAutoGenerated</B>
		</CODE><P>
		This method will use the Identity attributes of the object to retrieve the autogenerated 
attributes from the database.<P>

If the identity is not defined for this class/entity, then it will try to use the primary key 
to get the auto-generated values.<P>

Obviously this might generate a bug if one of the Identity attributes is autogenerated. 
This will create a trouble if some object does not have an identity defined but still contains 
some auto-generated attributes.
	
		<P><HR WIDTH=25% ALIGN=LEFT>
		<A NAME="- init"></A><H3><A NAME="//apple_ref/occ/instm/MCPObject/init">init</A></H3><P>
		<CODE>- (id)<B>init</B>
		</CODE><P>
		Taking care of getting the class description for <B>self</B> (after passing the message up).
	
		<P><HR WIDTH=25% ALIGN=LEFT>
		<A NAME="- primaryKey"></A><H3><A NAME="//apple_ref/occ/instm/MCPObject/primaryKey">primaryKey</A></H3><P>
		<CODE>- (NSDictionary *)<B>primaryKey</B>
		</CODE><P>
		Returns a dictionary with the values of the primary key.
	
		<P><HR WIDTH=25% ALIGN=LEFT>
		<A NAME="- readFromDBRow:withTableName:"></A><H3><A NAME="//apple_ref/occ/instm/MCPObject/readFromDBRow:withTableName:">readFromDBRow:withTableName:</A></H3><P>
		<CODE>- (id)<B>readFromDBRow:</B>(NSDictionary *)<EM>iDictionary</EM> <B>withTableName:</B>(NSString *)<EM>iTableName</EM>
			
		</CODE><P>
		Uses a query result row (described as a NSDictionary) to set the instance variables of <B>self</B>. If 
the result contains columns from multiple tables, the <I>iTableName</I> can be used to specify the alias 
used for the table name corresponding to the class.<P>

If <I>iTableName</I> == <B>nil</B>, the columns will be searched first without table name (column_name) and if 
not found then with the table name in front (from the class description : table_name.column_name).<P>

Otherwise, the search will be performed in the following order : <I>iTableName</I>.column_name, column_name, 
table_name.column_name.
	
		<P><HR WIDTH=25% ALIGN=LEFT>
		<A NAME="- saveInDB"></A><H3><A NAME="//apple_ref/occ/instm/MCPObject/saveInDB">saveInDB</A></H3><P>
		<CODE>- (NSDictionary *)<B>saveInDB</B>
		</CODE><P>
		First will use the checkDBIdWithConnection method to check if the entry is already in the database. If this is the case, 
it will use the updateInDB... method to update the current DB instance. Otherwise it will make an insert into the database 
to save the entry, than it makes a select to get the value of autogenerated column, and use them (if necessary) to return 
the primary key (as NSDictionary).<P>

As for checkDBId... the returned dictionary also have a MCPDBReturnCode key with a NSNumber as value containing the 
return code of the operation.
	
		<P><HR WIDTH=25% ALIGN=LEFT>
		<A NAME="- setAttributesToDefault"></A><H3><A NAME="//apple_ref/occ/instm/MCPObject/setAttributesToDefault">setAttributesToDefault</A></H3><P>
		<CODE>- (void)<B>setAttributesToDefault</B>
		</CODE><P>
		Set all the attributes to default values, except for auto-generated and primary key attributes, which are set to NULL.<P>

NOTE : !! In the current version the auto-generated and key are ALSO set to default values!!.
	
		<P><HR WIDTH=25% ALIGN=LEFT>
		<A NAME="- setConnection:"></A><H3><A NAME="//apple_ref/occ/instm/MCPObject/setConnection:">setConnection:</A></H3><P>
		<CODE>- (void)<B>setConnection:</B>(MCPConnection *)<EM>iConnection</EM>
			
		</CODE><P>
		No method description.
	
		<P><HR WIDTH=25% ALIGN=LEFT>
		<A NAME="- setNilValueForKey:"></A><H3><A NAME="//apple_ref/occ/instm/MCPObject/setNilValueForKey:">setNilValueForKey:</A></H3><P>
		<CODE>- (void)<B>setNilValueForKey:</B>(NSString *)<EM>iKey</EM>
			
		</CODE><P>
		No method description.
	
		<P><HR WIDTH=25% ALIGN=LEFT>
		<A NAME="- setPrimaryKey:andFetchFromDB:"></A><H3><A NAME="//apple_ref/occ/instm/MCPObject/setPrimaryKey:andFetchFromDB:">setPrimaryKey:andFetchFromDB:</A></H3><P>
		<CODE>- (MCPDBReturnCode)<B>setPrimaryKey:</B>(id)<EM>iDictionary</EM> <B>andFetchFromDB:</B>(MCPConnection *)<EM>iConnection</EM>
			
		</CODE><P>
		This method is used to retrieve an object from the DB given its precise primary key. It will return <B>self</B>. 
If the object is not found in the DB, then all instance variable are set to the default 
(and autogenerated/primary-key attributes are set to null).
	
		<P><HR WIDTH=25% ALIGN=LEFT>
		<A NAME="- updateInDB"></A><H3><A NAME="//apple_ref/occ/instm/MCPObject/updateInDB">updateInDB</A></H3><P>
		<CODE>- (MCPDBReturnCode)<B>updateInDB</B>
		</CODE><P>
		This method will use the primary key value held by the object to modify the object that is saved in the DB.<P>

(NO YET IMPLEMENTED) If the primary key is not complete (some of the attributes are to null or 0) and the identityAttributes 
(from class description) is not an empty list then it will perform a checkDBId... to try to retrieve the 
missing part of the primary key.
	




<P><HR>
Version 1.1 Copyright &copy;2004 by Serge Cohen.  All Rights Reserved.   Mon Aug 09 11:00:28 2004
<P>
</BODY></HTML>
